import{N as _e}from"./HeaderGPT-DGu0oUTL.js";import{T as de}from"./twitch-icon-D4pzET28.js";import{d as te,r as P,g as se,c as r,a as e,t as i,F as O,B as we,b as x,n as j,u as R,p as T,e as U,o as c,_ as ie,D as ue,m as q,w as le,q as ce,K as ge,I as ve,A as ae,z as oe,f as ne}from"./index-RmQaUy4U.js";import{l as be,f as ke,a as $e,i as pe,b as me,g as Ie}from"./ess3BuildPlayoffs-CwWSUyFB.js";import{b as Se}from"./SoloBuildStandings-DTpAlalr.js";import{I as Pe}from"./IconMarikasEye-DPFpUJre.js";import"./elden_squares-BChk0GbN.js";/* empty css                                                                  */function Me(w,g,y){const b={};return w.forEach(m=>{const _=m.wins+m.losses,n=g-_,s=m.wins,d=m.wins+n;if(w.filter(I=>{if(I.playerId===m.playerId)return!1;const A=g-(I.wins+I.losses);return I.wins+A>=s}).length<y){b[m.playerId]="yes";return}if(w.filter(I=>I.playerId===m.playerId?!1:I.wins>d).length>=y){b[m.playerId]="no";return}b[m.playerId]="maybe"}),b}function Ne(w,g,y=[],b=[],m=[]){const{matches:_,individualMaxGamesPlayed:n,playoffSlots:s}=w,d={};function $(t){if(d[t])return;const o=g[t];o&&(d[t]={id:t,displayName:o.displayName,wins:0,losses:0,squares:0,lines:0,h2h:{},gamesRemoved:0})}const p={};function I(t,o){p[t]??(p[t]={}),p[t][o]=(p[t][o]??0)+1}_.forEach(t=>{const[o,M]=t.participants,k=t.winner,C=o.id===k?M.id:o.id;$(o.id),$(M.id),!(!d[k]||!d[C])&&(I(o.id,M.id),I(M.id,o.id),d[k].wins++,d[C].losses++,d[o.id].squares+=o.score,d[M.id].squares+=M.score,t.method==="Bingo"&&d[k].lines++,d[k].h2h[C]=!0)}),y.forEach(t=>{$(t.winner),$(t.loser),!(!d[t.winner]||!d[t.loser])&&(I(t.winner,t.loser),I(t.loser,t.winner),d[t.winner].wins++,d[t.loser].losses++,d[t.winner].squares+=t.squaresAwarded,t.countsAsLine&&d[t.winner].lines++,d[t.winner].h2h[t.loser]=!0)}),b.forEach(t=>{$(t.receiver),d[t.receiver]&&(d[t.receiver].lines+=t.linesAwarded)}),m.forEach(t=>{if($(t.receiver),!d[t.receiver])return;const o=Number(t.gamesRemoved??0)||0;d[t.receiver].gamesRemoved+=o,d[t.receiver].wins-=t.gamesWon,d[t.receiver].losses+=t.gamesLost,d[t.receiver].squares-=t.squaresLost,d[t.receiver].lines-=t.linesLost});const A=Object.values(d).map(t=>{const o=t.wins+t.losses,M=Math.max(0,o-(t.gamesRemoved||0)),k=M>0?(t.wins/M*100).toFixed(1):"0.0",C=g[t.id];return{playerId:t.id,displayName:t.displayName,wins:t.wins,losses:t.losses,record:`${t.wins}-${t.losses}`,gamesPlayed:M,WR:k,squares:t.squares,lines:t.lines,h2h:t.h2h,Playoffs:"maybe",nickname:C==null?void 0:C.nickname,twitch:C==null?void 0:C.twitch,profilePic:C==null?void 0:C.profilePic,SoS:"0.0"}}),f={};A.forEach(t=>f[t.playerId]={wins:t.wins,losses:t.losses});function F(t,o){const M=t+o;return M>0?t/M:0}if(A.forEach(t=>{const o=p[t.playerId]??{};let M=0,k=0;for(const J in o){const Y=J,h=o[Y],a=f[Y];if(!a)continue;const L=F(a.wins,a.losses);M+=h,k+=L*h}const C=M>0?k/M*100:0;t.SoS=C.toFixed(1)}),A.sort((t,o)=>{if(o.wins!==t.wins)return o.wins-t.wins;if(t.losses!==o.losses)return t.losses-o.losses;if(t.h2h[o.playerId]&&!o.h2h[t.playerId])return-1;if(o.h2h[t.playerId]&&!t.h2h[o.playerId])return 1;const M=Number(t.SoS)||0,k=Number(o.SoS)||0;return M!==k?k-M:o.lines!==t.lines?o.lines-t.lines:o.squares!==t.squares?o.squares-t.squares:0}),A.every(t=>t.gamesPlayed>=n))return A.forEach((t,o)=>{t.Playoffs=o<s?"yes":"no"}),A;const V=Me(A,n,s);A.forEach(t=>{t.Playoffs=V[t.playerId]});let z=0;for(const t of A)t.Playoffs==="yes"&&(z++,z>s&&(t.Playoffs="maybe"));return A}const Ae={class:"standings-wrapper"},Ce={key:0,class:"loading"},Te={key:1,class:"error"},Le={class:"standings-list"},Be={class:"col-rank-number"},Re={class:"col-player"},Ee={class:"player-name"},We=["href"],je={class:"col-record-spacing"},qe={class:"col-wr"},Oe={class:"col-games"},Fe={class:"col-squares"},De={class:"col-lines"},Ue=te({__name:"StandingsAnamnesis",setup(w){const g=P([]),y=P(!0),b=P(null);async function m(_){const n=await fetch(_);if(!n.ok)throw new Error(`Failed to fetch ${_} (${n.status})`);return await n.json()}return se(async()=>{y.value=!0,b.value=null;try{const _=await m("/data/ScadubingoData/anamnesis/matches.json"),n=await m("/data/entries/players.json");let s=[],d=[];const $=[{receiver:"psiphicode",gamesRemoved:0,gamesWon:0,gamesLost:4,squaresLost:0,linesLost:0},{receiver:"blaze",gamesRemoved:0,gamesWon:0,gamesLost:4,squaresLost:0,linesLost:0},{receiver:"jxxman",gamesRemoved:0,gamesWon:0,gamesLost:0,squaresLost:0,linesLost:0},{receiver:"thomas",gamesRemoved:0,gamesWon:1,gamesLost:1,squaresLost:0,linesLost:0}];g.value=Ne(_,n,s,d,$)}catch(_){console.error(_),b.value=(_==null?void 0:_.message)??"Unknown error",g.value=[]}finally{y.value=!1}}),(_,n)=>(c(),r("div",Ae,[n[1]||(n[1]=e("h1",{class:"title"},"Anamnesis Standings",-1)),y.value?(c(),r("p",Ce,"Loadingâ€¦")):b.value?(c(),r("p",Te,i(b.value),1)):(c(),r(O,{key:2},[n[0]||(n[0]=we('<div class="standings-header" data-v-00c9212b><div class="col-rank" data-v-00c9212b>Rank</div><div class="col-player" data-v-00c9212b>Player</div><div class="col-record" data-v-00c9212b>Record</div><div class="col-wr" data-v-00c9212b>WR%</div><div class="col-games" data-v-00c9212b>GP</div><div class="col-squares" data-v-00c9212b>Squares</div><div class="col-lines" data-v-00c9212b>Lines</div></div>',1)),e("div",Le,[(c(!0),r(O,null,x(g.value,(s,d)=>(c(),r("div",{key:s.playerId,class:j(["team-card",{"playoff-yes":s.Playoffs==="yes","playoff-no":s.Playoffs==="no","playoff-maybe":s.Playoffs==="maybe"}])},[e("div",Be,i(d+1),1),e("div",Re,[e("h2",Ee,[R(i(s.nickname?`${s.displayName}`:s.displayName)+" ",1),s.twitch?(c(),r("a",{key:0,href:s.twitch,class:"twitch-link",target:"_blank",rel:"noreferrer"},[U(de,{class:"icon"})],8,We)):T("",!0)])]),e("div",je,i(s.record),1),e("div",qe,i(s.WR)+"%",1),e("div",Oe,i(s.gamesPlayed),1),e("div",Fe,i(s.squares),1),e("div",De,i(s.lines),1)],2))),128))])],64))]))}}),Ve=ie(Ue,[["__scopeId","data-v-00c9212b"]]);function Ge(w,g){const y={};Object.values(g).forEach(m=>{y[m.id]=m.displayName});const b={};return w.forEach(m=>{var d,$;b[m.week]||(b[m.week]={week:m.week,matches:[]});const[_,n]=m.participants,s=m.winner;b[m.week].matches.push({gameId:m.id,player1:{name:y[_.id]??String(_.id),score:_.score,outcome:_.id===s?m.method:"Lost"},player2:{name:y[n.id]??String(n.id),score:n.score,outcome:n.id===s?m.method:"Lost"},matchTime:m.duration,vodLink:(d=m.media)==null?void 0:d.vod,imageLink:($=m.media)==null?void 0:$.image})}),Object.values(b).sort((m,_)=>m.week-_.week)}const xe=te({name:"AnamnesisResults",setup(){const w=P([]),g=P(3),y=P(!1),b=P(null),m=[{label:"Week 1",value:1},{label:"Week 2",value:2},{label:"Week 3",value:3},{label:"All Weeks",value:"all"}];se(async()=>{try{const[p,I]=await Promise.all([fetch("/data/ScadubingoData/anamnesis/matches.json"),fetch("/data/entries/players.json")]);if(!p.ok)throw new Error("Failed to load matches.json");if(!I.ok)throw new Error("Failed to load players.json");const A=await p.json(),f=await I.json(),F=f.players??f;w.value=Ge(A.matches??A,F)}catch(p){console.error("Failed to load Anamnesis Match Results:",p)}});const _=q(()=>g.value==="all"?w.value:w.value.filter(p=>p.week===g.value));return{selectedWeek:g,weekOptions:m,filteredWeeks:_,openLink:p=>{window.open(p,"_blank")},openImageModal:p=>{b.value=p,y.value=!0},closeModal:()=>{y.value=!1,b.value=null},getPlayerClass:p=>p==="Bingo"||p==="Majority"?"winner":p==="Lost"?"loser":"",showModal:y,modalImage:b}}}),He={class:"match-results-container"},ze={class:"week-selector"},Ye=["onClick"],Ze={class:"week-title"},Ke={class:"matches-list"},Je={class:"match-line"},Xe={class:"score-line"},Qe={class:"match-details"},es={class:"match-buttons"},ss=["onClick"],ts=["onClick"],as={key:0,class:"no-results"},os={class:"modal-content"},ns=["src"];function ls(w,g,y,b,m,_){return c(),r("div",He,[g[4]||(g[4]=e("h2",{class:"title"},"Anamnesis Match Results",-1)),e("div",ze,[(c(!0),r(O,null,x(w.weekOptions,n=>(c(),r("button",{key:n.value,onClick:s=>w.selectedWeek=n.value,class:j(["week-button",{active:w.selectedWeek===n.value}])},i(n.label),11,Ye))),128))]),(c(!0),r(O,null,x(w.filteredWeeks,n=>(c(),r("div",{key:n.week,class:"week-block"},[e("h3",Ze,"Week "+i(n.week),1),e("div",Ke,[(c(!0),r(O,null,x(n.matches,s=>(c(),r("div",{key:s.gameId,class:"match-card"},[e("div",Je,[e("span",{class:j(["player-name",w.getPlayerClass(s.player1.outcome)])},i(s.player1.name),3),g[2]||(g[2]=e("span",{class:"vs-text"},"vs",-1)),e("span",{class:j(["player-name",w.getPlayerClass(s.player2.outcome)])},i(s.player2.name),3)]),e("div",Xe,[e("span",{class:j(["player-score",w.getPlayerClass(s.player1.outcome)])},i(s.player1.score),3),g[3]||(g[3]=e("span",{class:"dash"}," - ",-1)),e("span",{class:j(["player-score",w.getPlayerClass(s.player2.outcome)])},i(s.player2.score),3)]),e("div",Qe,[e("p",null,"Match Time: "+i(s.matchTime),1)]),e("div",es,[s.imageLink?(c(),r("button",{key:0,class:"match-button",onClick:d=>w.openImageModal(s.imageLink)}," View Board ",8,ss)):T("",!0),s.vodLink?(c(),r("button",{key:1,class:"match-button",onClick:d=>w.openLink(s.vodLink)}," Watch VOD ",8,ts)):T("",!0)])]))),128))])]))),128)),w.filteredWeeks.length===0?(c(),r("div",as," No match data available for this week. ")):T("",!0),w.showModal?(c(),r("div",{key:1,class:"modal-overlay",onClick:g[1]||(g[1]=ue((...n)=>w.closeModal&&w.closeModal(...n),["self"]))},[e("div",os,[e("button",{class:"close-button",onClick:g[0]||(g[0]=(...n)=>w.closeModal&&w.closeModal(...n))},"âœ•"),e("img",{src:w.modalImage,alt:"Match Board",class:"modal-image"},null,8,ns)])])):T("",!0)])}const is=ie(xe,[["render",ls],["__scopeId","data-v-c4826ac8"]]);function he(w){async function g(s){const d=`${w}?seriesId=${encodeURIComponent(s)}`,p=await(await fetch(d)).json();if(!p.ok)throw new Error(p.error);return p.data}async function y(s){return n({action:"upsertParticipants",seriesId:s.seriesId,round:s.round??"",playerAId:s.playerAId,playerBId:s.playerBId})}async function b(s){return n({action:"propose",seriesId:s.seriesId,by:s.by,timeIso:s.timeIso,note:s.note??""})}async function m(s){return n({action:"counter",seriesId:s.seriesId,by:s.by,timeIso:s.timeIso,note:s.note??""})}async function _(s){return n({action:"accept",seriesId:s.seriesId,by:s.by})}async function n(s){const $=await(await fetch(w,{method:"POST",headers:{"Content-Type":"text/plain;charset=utf-8"},body:JSON.stringify(s)})).json();if(!$.ok)throw new Error($.error);return $.data}return{getSchedule:g,upsertParticipants:y,propose:b,counter:m,accept:_}}const rs={class:"ms-modal"},cs={class:"ms-header"},ds={class:"ms-body"},us={key:0,class:"ms-loading"},vs={key:1,class:"ms-loading"},ps={class:"err"},ms={class:"ms-sub"},fs={key:0},ys={class:"ms-form",style:{"margin-bottom":"10px"}},hs={class:"lbl"},_s=["disabled"],ws=["value"],gs=["value"],bs={class:"ms-status"},ks={key:0,class:"confirmed"},$s={key:1,class:"proposed"},Is={key:0},Ss={key:2,class:"proposal-note"},Ps={key:3,class:"none"},Ms={key:0,class:"warn"},Ns={key:1,class:"warn"},As={class:"ms-form"},Cs={class:"lbl"},Ts=["disabled"],Ls={class:"lbl"},Bs=["disabled"],Rs={class:"btn-row"},Es=["disabled"],Ws=["disabled"],js={key:0,class:"accept-state"},fe="matchSchedule_who",qs=te({__name:"MatchScheduleModal",props:{apiUrl:{},open:{type:Boolean},seriesId:{},round:{},playerAId:{},playerBId:{},playerAName:{},playerBName:{},currentUserId:{}},emits:["close","updated"],setup(w,{emit:g}){const y=w,b=g,m=he(y.apiUrl),_=P(!1),n=P(""),s=P(null),d=P(""),$=P(""),p=P(y.currentUserId||"");le(()=>y.currentUserId,h=>{(!p.value||h)&&(p.value=h||"")}),se(()=>{const h=localStorage.getItem(fe);!p.value&&h&&(p.value=h)}),le(p,h=>{h&&localStorage.setItem(fe,h)});const I=q(()=>[y.playerAId,y.playerBId].includes(p.value)),A=q(()=>p.value===y.playerAId),f=q(()=>p.value===y.playerBId),F=q(()=>s.value?A.value?!!s.value.acceptedByA:f.value?!!s.value.acceptedByB:!1:!1),H=q(()=>s.value?A.value?!!s.value.acceptedByB:f.value?!!s.value.acceptedByA:!1:!1),V=q(()=>!s.value||!I.value||s.value.status==="confirmed"||!s.value.proposedTimeIso?!1:!F.value),z=q(()=>!I.value||!p.value?!1:d.value.length>0);function t(h){const a=new Date(h),L=Z=>String(Z).padStart(2,"0");return`${a.getFullYear()}-${L(a.getMonth()+1)}-${L(a.getDate())}T${L(a.getHours())}:${L(a.getMinutes())}`}function o(h){return new Date(h).toISOString()}const M=q(()=>{var a;return(a=s.value)!=null&&a.proposedTimeIso?new Date(s.value.proposedTimeIso).toLocaleString(void 0,{weekday:"short",month:"short",day:"2-digit",hour:"numeric",minute:"2-digit",timeZoneName:"short"}):""}),k=q(()=>{var a;return(a=s.value)!=null&&a.confirmedTimeIso?new Date(s.value.confirmedTimeIso).toLocaleString(void 0,{weekday:"short",month:"short",day:"2-digit",hour:"numeric",minute:"2-digit",timeZoneName:"short"}):""});async function C(){var h,a;_.value=!0,n.value="",s.value=null;try{await m.upsertParticipants({seriesId:y.seriesId,round:y.round??"",playerAId:y.playerAId,playerBId:y.playerBId}),s.value=await m.getSchedule(y.seriesId),(h=s.value)!=null&&h.proposedTimeIso?d.value=t(s.value.proposedTimeIso):d.value="",$.value=((a=s.value)==null?void 0:a.proposedNote)??""}catch(L){n.value=(L==null?void 0:L.message)??"Failed to load schedule"}finally{_.value=!1}}async function J(h){if(!(!I.value||!p.value||!d.value)){_.value=!0,n.value="";try{const a=o(d.value),L=h==="propose"?await m.propose({seriesId:y.seriesId,by:p.value,timeIso:a,note:$.value}):await m.counter({seriesId:y.seriesId,by:p.value,timeIso:a,note:$.value});s.value=L,b("updated",L)}catch(a){n.value=(a==null?void 0:a.message)??"Failed to submit"}finally{_.value=!1}}}async function Y(){if(!(!V.value||!p.value)){_.value=!0,n.value="";try{const h=await m.accept({seriesId:y.seriesId,by:p.value});s.value=h,b("updated",h)}catch(h){n.value=(h==null?void 0:h.message)??"Failed to accept"}finally{_.value=!1}}}return le(()=>y.open,h=>{h&&C()}),se(()=>{y.open&&C()}),(h,a)=>{var L,Z,K,u,v,N,S,E,D,l,W;return h.open?(c(),r("div",{key:0,class:"ms-overlay",onClick:a[5]||(a[5]=ue(B=>b("close"),["self"]))},[e("div",rs,[e("div",cs,[a[6]||(a[6]=e("h3",{class:"ms-title"},"ðŸ“… Schedule Match",-1)),e("button",{class:"ms-close",onClick:a[0]||(a[0]=B=>b("close"))},"âœ•")]),e("div",ds,[_.value||!s.value&&!n.value?(c(),r("div",us,a[7]||(a[7]=[e("div",{class:"spinner"},null,-1),e("p",{class:"load-title"},"Loading match terminal",-1),e("p",{class:"load-sub"},"Fetching current proposal / confirmation stateâ€¦",-1)]))):n.value?(c(),r("div",vs,[e("p",ps,"âŒ "+i(n.value),1),e("button",{class:"btn",onClick:C},"Retry")])):(c(),r(O,{key:2},[e("p",ms,[a[10]||(a[10]=e("b",null,"Series:",-1)),R(" "+i(h.seriesId)+" ",1),h.round?(c(),r("span",fs,[a[8]||(a[8]=R(" â€¢ ")),a[9]||(a[9]=e("b",null,"Round:",-1)),R(" "+i(h.round),1)])):T("",!0)]),e("div",ys,[e("label",hs,[a[12]||(a[12]=R(" Who are you? ")),ce(e("select",{class:"inp","onUpdate:modelValue":a[1]||(a[1]=B=>p.value=B),disabled:((L=s.value)==null?void 0:L.status)==="confirmed"},[a[11]||(a[11]=e("option",{value:""},"Select playerâ€¦",-1)),e("option",{value:h.playerAId},i(h.playerAName),9,ws),e("option",{value:h.playerBId},i(h.playerBName),9,gs)],8,_s),[[ge,p.value]])])]),e("div",bs,[e("span",{class:j(["pill",((Z=s.value)==null?void 0:Z.status)??"none"])},i(((K=s.value)==null?void 0:K.status)??"none"),3),((u=s.value)==null?void 0:u.status)==="confirmed"?(c(),r("div",ks,[a[13]||(a[13]=R(" âœ… Confirmed: ")),e("b",null,i(k.value),1)])):(v=s.value)!=null&&v.proposedTimeIso?(c(),r("div",$s,[a[15]||(a[15]=R(" Proposed: ")),e("b",null,i(M.value),1),(N=s.value)!=null&&N.proposedBy?(c(),r("span",Is,[a[14]||(a[14]=R(" â€¢ by ")),e("code",null,i(s.value.proposedBy),1)])):T("",!0)])):T("",!0),(S=s.value)!=null&&S.proposedNote?(c(),r("div",Ss,[a[16]||(a[16]=R(" ðŸ“ ")),a[17]||(a[17]=e("b",null,"Note:",-1)),R(" "+i(s.value.proposedNote),1)])):(c(),r("div",Ps," No proposed time yet. "))]),p.value&&!I.value?(c(),r("p",Ms," Selected user is not a participant for this series (read-only). ")):p.value?T("",!0):(c(),r("p",Ns," Select who you are to propose/accept. ")),e("div",As,[e("label",Cs,[a[18]||(a[18]=R(" Select time ")),ce(e("input",{class:"inp",type:"datetime-local","onUpdate:modelValue":a[2]||(a[2]=B=>d.value=B),disabled:_.value||((E=s.value)==null?void 0:E.status)==="confirmed"||!I.value||!p.value},null,8,Ts),[[ve,d.value]])]),e("label",Ls,[a[19]||(a[19]=R(" Note (optional) ")),ce(e("input",{class:"inp",type:"text","onUpdate:modelValue":a[3]||(a[3]=B=>$.value=B),placeholder:"e.g. after 7pm, avoid Friday",disabled:_.value||((D=s.value)==null?void 0:D.status)==="confirmed"||!I.value||!p.value},null,8,Bs),[[ve,$.value]])]),e("div",Rs,[e("button",{class:"btn primary",disabled:_.value||!z.value||((l=s.value)==null?void 0:l.status)==="confirmed",onClick:a[4]||(a[4]=B=>{var G;return J((G=s.value)!=null&&G.proposedTimeIso?"counter":"propose")})},i((W=s.value)!=null&&W.proposedTimeIso?"Counter with this time":"Propose this time"),9,Es),e("button",{class:"btn",disabled:_.value||!V.value,onClick:Y},i(F.value?"Accepted":"Accept proposed time"),9,Ws)]),s.value&&I.value&&s.value.status!=="confirmed"&&s.value.proposedTimeIso?(c(),r("p",js,[a[20]||(a[20]=R(" Your acceptance: ")),e("b",null,i(F.value?"Yes":"No"),1),a[21]||(a[21]=R(" â€¢ Other player: ")),e("b",null,i(H.value?"Accepted":"Not yet"),1)])):T("",!0)])],64))])])])):T("",!0)}}}),Os=ie(qs,[["__scopeId","data-v-d4acf3ea"]]),Fs={class:"team-colors"},Ds={class:"status-bar"},Us={key:0},Vs={key:1},Gs={key:2},xs={key:0,class:"next-match-pill"},Hs={class:"round-tag-bar"},zs={class:"round-pill"},Ys={class:"round-subtitle"},Zs={class:"series-pill-row"},Ks=["onClick"],Js={class:"layout"},Xs={class:"teams-column"},Qs={class:"team-card-header"},et={class:"team-title"},st={key:0,class:"winner-crown"},tt={class:"team-stats-grid"},at={class:"team-stat"},ot={class:"team-stat"},nt={class:"team-stat"},lt={class:"twitch-links"},it=["href"],rt={class:"twitch-text"},ct={class:"center-column"},dt={class:"series-header"},ut={class:"bo3-title"},vt={class:"is-match-ongoing"},pt={class:"series-outcome"},mt={key:0,class:"series-winner-banner"},ft={key:1},yt={class:"bo3-scoreboard"},ht={class:"team-score side left"},_t={class:"label"},wt={class:"score"},gt={class:"game-dots"},bt={class:"team-score side right"},kt={class:"score"},$t={class:"label"},It={class:"games-list"},St={class:"game-box-header"},Pt={class:"game-title"},Mt={key:0,class:"game-time"},Nt={class:"game-media"},At=["onClick"],Ct=["href"],Tt={class:"scores"},Lt={class:"outcome-text"},Bt={class:"modal-content"},Rt=["src"],ye="https://script.google.com/macros/s/AKfycbzCs1dnfDXN7ZlribbPbkqcfvZnAP26kH9OR0zAeDId1P2jGuUMW7klTPsmVSM4xTda/exec",Et="/data/ScadubingoData/anamnesis/playoffs.json",Wt="/data/ScadubingoData/anamnesis/matches.json",jt="/data/entries/players.json",qt=te({__name:"PlayoffsAnamnesis",setup(w){const g=he(ye),y=P({}),b=P(!1),m=P(""),_=P(""),n=P(""),s=P(""),d=P("");function $(u){m.value=u.series.id,_.value=u.round,n.value=u.series.participants[0],s.value=u.series.participants[1],b.value=!0}function p(u){u.status==="confirmed"&&u.confirmedTimeIso&&(y.value[u.seriesId]=u.confirmedTimeIso)}const I=new Map;async function A(u){const v=u.series.id;if(y.value[v])return;if(I.has(v)){await I.get(v);return}const N=(async()=>{try{const S=await g.getSchedule(v);(S==null?void 0:S.status)==="confirmed"&&S.confirmedTimeIso&&(y.value[v]=S.confirmedTimeIso)}finally{I.delete(v)}})();I.set(v,N),await N}const f=P([]),F=P({}),H=P(!1),V=P("");function z(u){u&&(V.value=u,H.value=!0)}function t(){H.value=!1,V.value=""}const o=P(0);function M(u){o.value=u}le(o,u=>{const v=f.value[u];v&&A(v)}),se(async()=>{const u=await be(Et);f.value=ke(u),o.value=$e(f.value);const v=f.value[o.value];v&&A(v);const[N,S]=await Promise.all([fetch(Wt).then(l=>l.json()),fetch(jt).then(l=>l.json())]),E=Se(N,S),D={};E.forEach(l=>D[l.playerId]=l),F.value=D});function k(u){return F.value[u]??null}function C(u){var v;return u.series.winner?((v=k(u.series.winner))==null?void 0:v.displayName)??"":""}function J(u){var S,E;const[v,N]=u.series.participants;return`${u.round} â€” ${((S=k(v))==null?void 0:S.displayName)??v} vs ${((E=k(N))==null?void 0:E.displayName)??N}`}function Y(u){if(typeof u!="string")return`Game ${u}`;const v=u.match(/-G(\d+)$/i);return v?`Game ${v[1]}`:u}function h(u){const v=y.value[u.series.id],N=v?new Date(v):Ie(u);return N?N.toLocaleString(void 0,{month:"short",day:"2-digit",hour:"numeric",minute:"2-digit",timeZoneName:"short"}):""}function a(u){return u?`var(--${u}, var(--team-unknown))`:"var(--team-unknown)"}function L(u,v){const N=u.series.games[v];if(!N||!N.winner)return{background:"#222",borderColor:"#555",opacity:.35};const S=a(N.winner);return{background:`color-mix(in srgb, ${S} 35%, #000 65%)`,borderColor:S,boxShadow:`0 0 12px ${S}`,opacity:1}}const Z=q(()=>{var W,B;const u=f.value[o.value];if(!u)return"";const[v,N]=u.series.participants,S=u.series.winsByTeam[v]??0,E=u.series.winsByTeam[N]??0,D=((W=k(v))==null?void 0:W.displayName)??v,l=((B=k(N))==null?void 0:B.displayName)??N;return S===0&&E===0?"Series not started":u.series.winner?"MATCH COMPLETED":S===E?`Series tied ${S}-${E}`:S>E?`${D} leads ${S}-${E}`:`${l} leads ${E}-${S}`});function K(u){const v=k(u);return v?{name:v.displayName,twitch:v.twitch}:null}return(u,v)=>{var N,S,E,D;return c(),r(O,null,[e("div",Fs,[f.value.length?(c(),r("div",{key:0,class:"match-wrapper",style:ae({"--team-color":a(f.value[o.value].series.winner)})},[e("div",Ds,[e("div",{class:j(["status-pill",{live:oe(me)(f.value[o.value]),finished:oe(pe)(f.value[o.value])}])},[oe(me)(f.value[o.value])?(c(),r("span",Us,"LIVE")):oe(pe)(f.value[o.value])?(c(),r("span",Vs," Completed Series")):(c(),r("span",Gs,"UPCOMING"))],2),h(f.value[o.value])?(c(),r("p",xs," Next Match: "+i(h(f.value[o.value])),1)):T("",!0),e("button",{class:"series-pill",onClick:v[0]||(v[0]=l=>$(f.value[o.value]))}," Schedule / Propose ")]),e("div",Hs,[e("span",zs,i(f.value[o.value].round),1),e("p",null,i(f.value[o.value].tag),1),e("span",Ys," Best of "+i(f.value[o.value].series.bestOf),1)]),e("div",Zs,[(c(!0),r(O,null,x(f.value,(l,W)=>(c(),r("button",{key:l.series.id,class:j(["series-pill",{active:W===o.value}]),onClick:B=>M(W)},i(J(l)),11,Ks))),128))]),e("div",Js,[e("div",Xs,[(c(!0),r(O,null,x(f.value[o.value].series.participants,l=>{var W,B,G,X,Q,re,ee;return c(),r("div",{key:l,class:j(["team-card-inner",{"winner-glow":f.value[o.value].series.winner===l}]),style:ae({"--team-color":a(l)})},[e("div",Qs,[e("h2",et,[R(i(((W=k(l))==null?void 0:W.displayName)??l)+" ",1),f.value[o.value].series.winner===l?(c(),r("span",st,"ðŸ‘‘")):T("",!0)])]),e("div",tt,[e("p",at,[v[2]||(v[2]=e("span",null,"Record",-1)),e("strong",null,i(((B=k(l))==null?void 0:B.record)??"â€”"),1)]),e("p",ot,[v[3]||(v[3]=e("span",null,"Squares",-1)),e("strong",null,i(((G=k(l))==null?void 0:G.squares)??"â€”"),1)]),e("p",nt,[v[4]||(v[4]=e("span",null,"Lines",-1)),e("strong",null,i(((X=k(l))==null?void 0:X.lines)??"â€”"),1)])]),e("div",lt,[(Q=K(l))!=null&&Q.twitch?(c(),r("a",{key:0,href:(re=K(l))==null?void 0:re.twitch,target:"_blank",class:"twitch-link"},[U(de,{class:"twitch-icon"}),e("span",rt,i((ee=K(l))==null?void 0:ee.name),1)],8,it)):T("",!0)])],6)}),128))]),e("div",ct,[e("div",dt,[e("h3",ut,"BEST OF "+i(f.value[o.value].series.bestOf),1),e("p",vt,i(Z.value),1),e("p",pt,[f.value[o.value].series.winner?(c(),r("span",mt,[v[5]||(v[5]=e("span",{class:"crown-icon"},"ðŸ‘‘",-1)),R(" "+i(C(f.value[o.value]))+" wins the series! ",1)])):(c(),r("span",ft,"Series in progress"))])]),e("div",yt,[e("div",ht,[e("span",_t,i((N=k(f.value[o.value].series.participants[0]))==null?void 0:N.displayName),1),e("span",wt,i(f.value[o.value].series.winsByTeam[f.value[o.value].series.participants[0]]??0),1)]),e("div",gt,[(c(!0),r(O,null,x(f.value[o.value].series.bestOf,l=>{var W;return c(),r("div",{key:"dot-"+l,class:j(["game-dot",{"not-played":!((W=f.value[o.value].series.games[l-1])!=null&&W.winner)}]),style:ae(L(f.value[o.value],l-1))},i(l),7)}),128))]),e("div",bt,[e("span",kt,i(f.value[o.value].series.winsByTeam[f.value[o.value].series.participants[1]]??0),1),e("span",$t,i((S=k(f.value[o.value].series.participants[1]))==null?void 0:S.displayName),1)])]),e("div",It,[(c(!0),r(O,null,x(f.value[o.value].series.games,l=>{var W,B,G,X,Q;return c(),r("div",{key:l.id,class:"game-box",style:ae({"--team-color":a(l.winner)})},[e("div",St,[e("h4",Pt,i(Y(l.id)),1),l.duration?(c(),r("span",Mt," â± "+i(l.duration),1)):T("",!0)]),e("div",Nt,[(W=l.media)!=null&&W.image?(c(),r("button",{key:0,class:"image-button",onClick:re=>{var ee;return z((ee=l.media)==null?void 0:ee.image)}},[U(Pe,{class:"marika-eye"})],8,At)):T("",!0),(B=l.media)!=null&&B.vod?(c(),r("a",{key:1,class:"vod-button",href:(G=l.media)==null?void 0:G.vod,target:"_blank"},[U(de,{class:"youtube-icon"})],8,Ct)):T("",!0)]),e("div",Tt,[e("p",{class:j({winner:l.winner===l.participants[0].id})},[R(i(((X=k(l.participants[0].id))==null?void 0:X.displayName)??l.participants[0].id)+" â€” ",1),e("strong",null,i(l.participants[0].score),1)],2),e("p",{class:j({winner:l.winner===l.participants[1].id})},[R(i(((Q=k(l.participants[1].id))==null?void 0:Q.displayName)??l.participants[1].id)+" â€” ",1),e("strong",null,i(l.participants[1].score),1)],2)]),e("p",Lt,i(l.method??"No result yet"),1)],4)}),128))])])])],4)):T("",!0)]),H.value?(c(),r("div",{key:0,class:"modal-overlay",onClick:ue(t,["self"])},[e("div",Bt,[e("button",{class:"close-button",onClick:t},"âœ•"),e("img",{src:V.value,alt:"Match Board",class:"modal-image"},null,8,Rt)])])):T("",!0),U(Os,{"api-url":ye,open:b.value,"series-id":m.value,round:_.value,"player-a-id":n.value,"player-b-id":s.value,"player-a-name":((E=k(n.value))==null?void 0:E.displayName)??n.value,"player-b-name":((D=k(s.value))==null?void 0:D.displayName)??s.value,"current-user-id":d.value,onUpdated:p,onClose:v[1]||(v[1]=l=>b.value=!1)},null,8,["open","series-id","round","player-a-id","player-b-id","player-a-name","player-b-name","current-user-id"])],64)}}}),Ot="/scadubingo-public/Anamnesis_Logo_Transparent.png",Ft=te({name:"Anamnesis",components:{Navigation:_e,Standings:Ve,MatchResults:is,Playoffs:qt},mounted(){document.body.style.background="linear-gradient(182deg,rgba(10, 10, 10, 1) 0%, rgba(0, 0, 0, 1) 25%, rgba(0, 46, 42, 1) 100%)"},beforeUnmount(){document.body.style.background="#0d1321"}}),Dt={class:"main-container"};function Ut(w,g,y,b,m,_){const n=ne("Navigation"),s=ne("Playoffs"),d=ne("Standings"),$=ne("MatchResults");return c(),r("div",null,[U(n),e("div",Dt,[g[0]||(g[0]=e("div",{class:"top-image-container"},[e("img",{src:Ot,class:"logo"})],-1)),U(s),U(d),U($)])])}const Jt=ie(Ft,[["render",Ut],["__scopeId","data-v-61c490ed"]]);export{Jt as default};
