import{d as $,r as h,o as d,c as b,a as e,F as g,b as y,t as m,_ as S,e as P,f as L,g as T,n as C,h as R,i as w,w as M,M as A,T as B,I,D as E,H as F,j as k,k as N,l as W}from"./index-Bjw4E4iZ.js";const q="/data/crucibleStandings.json";async function x(){return fetch(q).then(l=>l.json()).then(l=>{for(let a=0;a<l.CruciblePlayers.length;a++){var t=l.CruciblePlayers[a].wins,p=l.CruciblePlayers[a].wins+l.CruciblePlayers[a].losses;l.CruciblePlayers[a].games=p;var v=V(t,p);l.CruciblePlayers[a].wr=v;var n=l.CruciblePlayers[a].opponentWins,c=l.CruciblePlayers[a].opponentLoss;l.CruciblePlayers[a].recordStrength=n/(c+n)}return l.CruciblePlayers.sort((a,r)=>{if(r.wins!==a.wins)return r.wins-a.wins;const i=Number(a.wr.substring(0,a.wr.length-1)),s=Number(r.wr.substring(0,r.wr.length-1));return s!==i?s-i:r.recordStrength-a.recordStrength}).forEach((a,r)=>{a.standing=r+1}),l})}function V(l,t){if(l===0||t===0)return"0%";{var p=l/t*100;const n=`${Math.round(p)}%`;return String(n)}}const H={class:"table-container"},z={class:"table-wrapper"},G={class:"horizontal-lines-table"},K=$({__name:"CrucibleTable",props:{CruciblePlayers:{}},setup(l){const t=h(["Standing","Player","Wins","Losses","Games","WR"]),p=h(["standing","name","wins","losses","games","wr"]);return(v,n)=>(d(),b("div",H,[e("div",z,[n[0]||(n[0]=e("h2",{class:"redmanes-header"},"The Crucible",-1)),e("table",G,[e("thead",null,[e("tr",null,[(d(!0),b(g,null,y(t.value,(c,a)=>(d(),b("th",{key:"table1-header-"+a},m(c),1))),128))])]),e("tbody",null,[(d(!0),b(g,null,y(v.CruciblePlayers,(c,a)=>(d(),b("tr",{key:"table1-row-rednames"+a},[(d(!0),b(g,null,y(p.value,r=>(d(),b("td",null,m(c[r]),1))),256))]))),128))])])])]))}}),O=S(K,[["__scopeId","data-v-7d1f5af4"]]),U=async()=>{const l="/data/normalizedResults.json";try{const t=await fetch(l);if(!t.ok)throw new Error(`Failed to fetch stats: ${t.statusText}`);const p=await t.json();if(!p.crucible)throw new Error("Crucible data not found.");return{matches:p.crucible.flatMap(n=>n.matches.map(c=>({...c,week:n.week})))}}catch(t){throw console.error(t),new Error("Failed to load Crucible stats. Please try again later.")}},Y={class:"container"},J={key:0,class:"error"},Q={class:"table-container"},X={class:"results-table"},Z={class:"table-caption"},j={class:"week-button-group"},D=["onClick"],ee={rowspan:2},te={rowspan:2},se={rowspan:2},ae=["src"],re=$({__name:"CrucibleResultsTable",setup(l){const t=h({matches:[]}),p=h(!1),v=h(void 0),n=h(null),c=h(null),a=o=>{v.value=o,p.value=!0},r=o=>o==="Bingo"||o==="Majority"?"highlight-green":o==="Lost"?"highlight-red":"",i=P(()=>{const o=new Set(t.value.matches.map(_=>_.week));return Array.from(o).sort((_,u)=>_-u)}),s=P(()=>c.value!==null?t.value.matches.filter(o=>o.week===c.value):t.value.matches);return L(async()=>{try{t.value=await U();const o=i.value;o.length>0&&(c.value=o[5])}catch(o){n.value=o.message}}),(o,_)=>(d(),b("div",Y,[n.value?(d(),b("div",J,m(n.value),1)):T("",!0),e("div",Q,[e("table",X,[e("caption",Z,[e("div",j,[(d(!0),b(g,null,y(i.value,u=>(d(),b("button",{key:u,class:C(["week-button",{active:c.value===u}]),onClick:f=>c.value=u}," Week "+m(u),11,D))),128)),e("button",{class:C(["week-button",{active:c.value===null}]),onClick:_[0]||(_[0]=u=>c.value=null)}," All Weeks ",2)])]),_[2]||(_[2]=e("thead",null,[e("tr",null,[e("th",null,"Game"),e("th",null,"Player"),e("th",null,"Score"),e("th",null,"Win Condition"),e("th",null,"Match Time"),e("th",null,"Board")])],-1)),e("tbody",null,[(d(!0),b(g,null,y(s.value,(u,f)=>(d(),b(g,{key:f},[e("tr",{class:C({"new-game-row":f===0||s.value[f-1].gameId!==u.gameId})},[e("td",ee,m(u.gameId),1),e("td",{class:C(r(u.player1.outcome))},m(u.player1.name),3),e("td",{class:C(r(u.player1.outcome))},m(u.player1.score),3),e("td",{class:C(r(u.player1.outcome))},m(u.player1.outcome),3),e("td",te,m(u.matchTime),1),e("td",se,[u.imageLink?(d(),R(I,{key:0,onClick:Ce=>a(u.imageLink),class:"marika-eye"},null,8,["onClick"])):T("",!0)])],2),e("tr",null,[e("td",{class:C(r(u.player2.outcome))},m(u.player2.name),3),e("td",{class:C(r(u.player2.outcome))},m(u.player2.score),3),e("td",{class:C(r(u.player2.outcome))},m(u.player2.outcome),3)])],64))),128))])])]),(d(),R(B,{to:"body"},[w(A,{show:p.value,onClose:_[1]||(_[1]=u=>p.value=!1)},{default:M(()=>[e("img",{src:v.value,alt:"Board Image",style:{"max-width":"100%",height:"auto"}},null,8,ae)]),_:1},8,["show"])]))]))}}),le=S(re,[["__scopeId","data-v-2104827c"]]),ne=async()=>{const l="/data/crucibleSquareStats.json";try{const t=await fetch(l);if(!t.ok)throw new Error(`Failed to fetch challenge records: ${t.statusText}`);const p=await t.json();return{records:Object.entries(p).map(([n,c])=>({name:n,completed:c.Completed,appeared:c.Appeared,ratio:c.Ratio,appearance:c.Appearance}))}}catch(t){throw console.error(t),new Error("Failed to load challenge records. Please try again later.")}},oe={class:"container"},ce={key:0,class:"error"},ue={key:1,class:"table-container"},ie={class:"results-table"},de={class:"left-column"},pe=$({__name:"CrucibleSquareStatsTable",setup(l){const t=h({records:[]}),p=h(null),v=h("name"),n=h("asc");L(async()=>{let r=73;try{const i=await ne();t.value.records=i.records.map(s=>{const o=s.appeared>0?Number((s.completed/s.appeared*100).toFixed(0)):0,_=Number((s.appeared/r*100).toFixed(0));return{...s,ratio:o,appearance:_}}),t.value.records.sort((s,o)=>s.name.localeCompare(o.name))}catch(i){p.value=i.message}});const c=r=>{v.value===r?n.value=n.value==="asc"?"desc":"asc":(v.value=r,n.value="desc"),t.value.records.sort((i,s)=>{let o=parseFloat(i[r]),_=parseFloat(s[r]);return n.value==="asc"?o-_:_-o})},a=()=>{v.value==="name"?n.value=n.value==="asc"?"desc":"asc":(v.value="name",n.value="desc"),t.value.records.sort((r,i)=>{const s=r.name.toLowerCase(),o=i.name.toLowerCase();return n.value==="asc"?s.localeCompare(o):o.localeCompare(s)})};return(r,i)=>(d(),b("div",oe,[p.value?(d(),b("div",ce,m(p.value),1)):(d(),b("div",ue,[e("table",ie,[e("thead",null,[e("tr",null,[e("th",{onClick:a,class:"sortable"},"Square Name ⬍"),e("th",{onClick:i[0]||(i[0]=s=>c("completed")),class:"sortable"},"Completed ⬍"),e("th",{onClick:i[1]||(i[1]=s=>c("appeared")),class:"sortable"},"Appeared ⬍"),e("th",{onClick:i[2]||(i[2]=s=>c("ratio")),class:"sortable"},"Completion % ⬍"),e("th",{onClick:i[3]||(i[3]=s=>c("appearance")),class:"sortable"},"Appearance % ⬍")])]),e("tbody",null,[(d(!0),b(g,null,y(t.value.records,(s,o)=>(d(),b("tr",{key:o},[e("td",de,m(s.name),1),e("td",null,m(s.completed),1),e("td",null,m(s.appeared),1),e("td",null,m(s.ratio)+"%",1),e("td",null,m(s.appearance)+"%",1)]))),128))])])]))]))}}),be=S(pe,[["__scopeId","data-v-1d6799f8"]]),me={name:"CrucibleView",components:{CrucibleTable:O,Divider:E,HeaderView:F,CrucibleResultsTable:le,CrucibleSquareStatsTable:be},data(){return{table:{cruciblePlayers:{CruciblePlayers:[]}}}},created(){x().then(l=>{console.log(l),this.table.cruciblePlayers=l})}},ve={class:"main-container"},_e={class:"table-container"};function he(l,t,p,v,n,c){const a=k("HeaderView"),r=k("CrucibleTable"),i=k("CrucibleResultsTable"),s=k("CrucibleSquareStatsTable");return d(),b(g,null,[w(a),e("div",ve,[t[2]||(t[2]=e("div",{class:"top-image-container"},[e("img",{src:N,alt:"Stars Ending",class:"grayscale-image"}),e("img",{src:W,alt:"Logo",class:"logo-image"})],-1)),t[3]||(t[3]=e("h1",{class:"header"},"The Crucible Standings",-1)),e("div",_e,[w(r,{CruciblePlayers:n.table.cruciblePlayers.CruciblePlayers},null,8,["CruciblePlayers"])]),e("div",null,[t[0]||(t[0]=e("h1",null,"Crucible Results",-1)),w(i)]),e("div",null,[t[1]||(t[1]=e("h1",null,"Crucible Square Stats",-1)),w(s)])])],64)}const ye=S(me,[["render",he],["__scopeId","data-v-65b3f502"]]);export{ye as default};
