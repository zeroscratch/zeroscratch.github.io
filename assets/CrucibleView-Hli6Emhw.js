import{d as P,r as y,o as n,c,a as e,F as g,b as h,t as u,_ as v,e as k,f,g as m,w as T,M as R,T as $,n as _,I as S,h as L,D as I,H as M,i as w,j as E,k as V}from"./index-CLY6gicG.js";const B="/data/crucibleStandings.json";async function W(){return fetch(B).then(s=>s.json()).then(s=>{for(let r=0;r<s.CruciblePlayers.length;r++){var l=s.CruciblePlayers[r].wins,o=s.CruciblePlayers[r].wins+s.CruciblePlayers[r].losses;s.CruciblePlayers[r].games=o;var d=x(l,o);s.CruciblePlayers[r].wr=d;var i=s.CruciblePlayers[r].opponentWins,b=s.CruciblePlayers[r].opponentLoss;s.CruciblePlayers[r].recordStrength=i/(b+i)}return s.CruciblePlayers.sort((r,t)=>t.wins!==r.wins?t.wins-r.wins:t.recordStrength-r.recordStrength).forEach((r,t)=>r.standing=t+1),s})}function x(s,l){if(s===0||l===0)return"0%";{var o=s/l*100;const i=`${Math.round(o)}%`;return String(i)}}const F={class:"table-container"},H={class:"table-wrapper"},N={class:"horizontal-lines-table"},z=P({__name:"CrucibleTable",props:{CruciblePlayers:{}},setup(s){const l=y(["Standing","Player","Wins","Losses","Games","WR"]),o=y(["standing","name","wins","losses","games","wr"]);return(d,i)=>(n(),c("div",F,[e("div",H,[i[0]||(i[0]=e("h2",{class:"redmanes-header"},"The Crucible",-1)),e("table",N,[e("thead",null,[e("tr",null,[(n(!0),c(g,null,h(l.value,(b,r)=>(n(),c("th",{key:"table1-header-"+r},u(b),1))),128))])]),e("tbody",null,[(n(!0),c(g,null,h(d.CruciblePlayers,(b,r)=>(n(),c("tr",{key:"table1-row-rednames"+r},[(n(!0),c(g,null,h(o.value,t=>(n(),c("td",null,u(b[t]),1))),256))]))),128))])])])]))}}),A=v(z,[["__scopeId","data-v-7d1f5af4"]]),G=async()=>{const s="/data/normalizedResults.json";try{const l=await fetch(s);if(!l.ok)throw new Error(`Failed to fetch stats: ${l.statusText}`);const o=await l.json();if(!o.crucible)throw new Error("Crucible data not found.");return{matches:o.crucible}}catch(l){throw console.error(l),new Error("Failed to load Crucible stats. Please try again later.")}},U={class:"container"},Y={key:0,class:"error"},q={key:1,class:"table-container"},J={class:"results-table",border:"0"},K={rowspan:2},Q={rowspan:2},X={rowspan:2},Z=["src"],O=P({__name:"CrucibleResultsTable",setup(s){const l=y({matches:[]}),o=y(!1),d=y(void 0),i=y(null),b=t=>{d.value=t,o.value=!0},r=t=>t==="Bingo"||t==="Majority"?"highlight-green":t==="Lost"?"highlight-red":"";return k(async()=>{try{l.value=await G()}catch(t){i.value=t.message}}),(t,p)=>(n(),c("div",U,[i.value?(n(),c("div",Y,u(i.value),1)):(n(),c("div",q,[e("table",J,[p[1]||(p[1]=e("thead",null,[e("tr",null,[e("th",null,"Game"),e("th",null,"Player"),e("th",null,"Score"),e("th",null,"Win Condition"),e("th",null,"Match Time"),e("th",null,"Board")])],-1)),e("tbody",null,[(n(!0),c(g,null,h(l.value.matches,(a,C)=>(n(),c(g,{key:C},[e("tr",{class:_({"new-game-row":C===0||l.value.matches[C-1].gameId!==a.gameId})},[e("td",K,u(a.gameId),1),e("td",{class:_(r(a.player1.outcome))},u(a.player1.name),3),e("td",{class:_(r(a.player1.outcome))},u(a.player1.score),3),e("td",{class:_(r(a.player1.outcome))},u(a.player1.outcome),3),e("td",Q,u(a.matchTime),1),e("td",X,[a.imageLink?(n(),f(S,{key:0,onClick:le=>b(a.imageLink)},null,8,["onClick"])):L("",!0)])],2),e("tr",null,[e("td",{class:_(r(a.player2.outcome))},u(a.player2.name),3),e("td",{class:_(r(a.player2.outcome))},u(a.player2.score),3),e("td",{class:_(r(a.player2.outcome))},u(a.player2.outcome),3)])],64))),128))])])])),(n(),f($,{to:"body"},[m(R,{show:o.value,onClose:p[0]||(p[0]=a=>o.value=!1)},{default:T(()=>[e("img",{src:d.value,alt:"Board Image",style:{"max-width":"100%",height:"auto"}},null,8,Z)]),_:1},8,["show"])]))]))}}),j=v(O,[["__scopeId","data-v-22552334"]]),D={name:"CrucibleView",components:{CrucibleTable:A,Divider:I,HeaderView:M,CrucibleResultsTable:j},data(){return{table:{cruciblePlayers:{CruciblePlayers:[]}}}},created(){W().then(s=>{console.log(s),this.table.cruciblePlayers=s})}},ee={class:"main-container"},re={class:"table-container"};function se(s,l,o,d,i,b){const r=w("HeaderView"),t=w("CrucibleTable"),p=w("CrucibleResultsTable");return n(),c(g,null,[m(r),e("div",ee,[l[1]||(l[1]=e("div",{class:"top-image-container"},[e("img",{src:E,alt:"Stars Ending",class:"grayscale-image"}),e("img",{src:V,alt:"Logo",class:"logo-image"})],-1)),l[2]||(l[2]=e("h1",{class:"header"},"The Crucible Standings",-1)),e("div",re,[m(t,{CruciblePlayers:i.table.cruciblePlayers.CruciblePlayers},null,8,["CruciblePlayers"])]),e("div",null,[l[0]||(l[0]=e("h1",null,"Crucible Results",-1)),m(p)])])],64)}const ae=v(D,[["render",se],["__scopeId","data-v-31592bca"]]);export{ae as default};
