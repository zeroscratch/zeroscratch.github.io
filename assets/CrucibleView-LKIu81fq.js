import{d as R,r as v,o as i,c as d,a as e,F as y,b as g,t as b,_ as P,e as S,f as M,g as T,n as m,h as $,i as h,w as L,M as I,T as W,I as E,D as V,H as B,j as k,k as x,l as q}from"./index-DV7ALihc.js";import{C as A}from"./CrucibleSquareStatsTable-CHjCwF3a.js";const F="/data/crucibleStandings.json";async function H(){return fetch(F).then(s=>s.json()).then(s=>{for(let r=0;r<s.CruciblePlayers.length;r++){var t=s.CruciblePlayers[r].wins,c=s.CruciblePlayers[r].wins+s.CruciblePlayers[r].losses;s.CruciblePlayers[r].games=c;var _=N(t,c);s.CruciblePlayers[r].wr=_;var a=s.CruciblePlayers[r].opponentWins,n=s.CruciblePlayers[r].opponentLoss;s.CruciblePlayers[r].recordStrength=a/(n+a)}return s.CruciblePlayers.sort((r,o)=>o.wins!==r.wins?o.wins-r.wins:o.recordStrength-r.recordStrength).forEach((r,o)=>r.standing=o+1),s})}function N(s,t){if(s===0||t===0)return"0%";{var c=s/t*100;const a=`${Math.round(c)}%`;return String(a)}}const z={class:"table-container"},G={class:"table-wrapper"},U={class:"horizontal-lines-table"},Y=R({__name:"CrucibleTable",props:{CruciblePlayers:{}},setup(s){const t=v(["Standing","Player","Wins","Losses","Games","WR"]),c=v(["standing","name","wins","losses","games","wr"]);return(_,a)=>(i(),d("div",z,[e("div",G,[a[0]||(a[0]=e("h2",{class:"redmanes-header"},"The Crucible",-1)),e("table",U,[e("thead",null,[e("tr",null,[(i(!0),d(y,null,g(t.value,(n,r)=>(i(),d("th",{key:"table1-header-"+r},b(n),1))),128))])]),e("tbody",null,[(i(!0),d(y,null,g(_.CruciblePlayers,(n,r)=>(i(),d("tr",{key:"table1-row-rednames"+r},[(i(!0),d(y,null,g(c.value,o=>(i(),d("td",null,b(n[o]),1))),256))]))),128))])])])]))}}),J=P(Y,[["__scopeId","data-v-7d1f5af4"]]),K=async()=>{const s="/data/normalizedResults.json";try{const t=await fetch(s);if(!t.ok)throw new Error(`Failed to fetch stats: ${t.statusText}`);const c=await t.json();if(!c.crucible)throw new Error("Crucible data not found.");return{matches:c.crucible.flatMap(a=>a.matches.map(n=>({...n,week:a.week})))}}catch(t){throw console.error(t),new Error("Failed to load Crucible stats. Please try again later.")}},Q={class:"container"},X={key:0,class:"error"},Z={class:"table-container"},O={class:"results-table"},j={class:"table-caption"},D={class:"week-button-group"},ee=["onClick"],te={rowspan:2},le={rowspan:2},se={rowspan:2},re=["src"],ae=R({__name:"CrucibleResultsTable",setup(s){const t=v({matches:[]}),c=v(!1),_=v(void 0),a=v(null),n=v(null),r=u=>{_.value=u,c.value=!0},o=u=>u==="Bingo"||u==="Majority"?"highlight-green":u==="Lost"?"highlight-red":"",C=S(()=>{const u=new Set(t.value.matches.map(p=>p.week));return Array.from(u).sort((p,l)=>p-l)}),w=S(()=>n.value!==null?t.value.matches.filter(u=>u.week===n.value):t.value.matches);return M(async()=>{try{t.value=await K();const u=C.value;u.length>0&&(n.value=u[2])}catch(u){a.value=u.message}}),(u,p)=>(i(),d("div",Q,[a.value?(i(),d("div",X,b(a.value),1)):T("",!0),e("div",Z,[e("table",O,[e("caption",j,[e("div",D,[(i(!0),d(y,null,g(C.value,l=>(i(),d("button",{key:l,class:m(["week-button",{active:n.value===l}]),onClick:f=>n.value=l}," Week "+b(l),11,ee))),128)),e("button",{class:m(["week-button",{active:n.value===null}]),onClick:p[0]||(p[0]=l=>n.value=null)}," All Weeks ",2)])]),p[2]||(p[2]=e("thead",null,[e("tr",null,[e("th",null,"Game"),e("th",null,"Player"),e("th",null,"Score"),e("th",null,"Win Condition"),e("th",null,"Match Time"),e("th",null,"Board")])],-1)),e("tbody",null,[(i(!0),d(y,null,g(w.value,(l,f)=>(i(),d(y,{key:f},[e("tr",{class:m({"new-game-row":f===0||w.value[f-1].gameId!==l.gameId})},[e("td",te,b(l.gameId),1),e("td",{class:m(o(l.player1.outcome))},b(l.player1.name),3),e("td",{class:m(o(l.player1.outcome))},b(l.player1.score),3),e("td",{class:m(o(l.player1.outcome))},b(l.player1.outcome),3),e("td",le,b(l.matchTime),1),e("td",se,[l.imageLink?(i(),$(E,{key:0,onClick:de=>r(l.imageLink),class:"marika-eye"},null,8,["onClick"])):T("",!0)])],2),e("tr",null,[e("td",{class:m(o(l.player2.outcome))},b(l.player2.name),3),e("td",{class:m(o(l.player2.outcome))},b(l.player2.score),3),e("td",{class:m(o(l.player2.outcome))},b(l.player2.outcome),3)])],64))),128))])])]),(i(),$(W,{to:"body"},[h(I,{show:c.value,onClose:p[1]||(p[1]=l=>c.value=!1)},{default:L(()=>[e("img",{src:_.value,alt:"Board Image",style:{"max-width":"100%",height:"auto"}},null,8,re)]),_:1},8,["show"])]))]))}}),ne=P(ae,[["__scopeId","data-v-48458b96"]]),oe={name:"CrucibleView",components:{CrucibleTable:J,Divider:V,HeaderView:B,CrucibleResultsTable:ne,CrucibleSquareStatsTable:A},data(){return{table:{cruciblePlayers:{CruciblePlayers:[]}}}},created(){H().then(s=>{console.log(s),this.table.cruciblePlayers=s})}},ie={class:"main-container"},ue={class:"table-container"};function ce(s,t,c,_,a,n){const r=k("HeaderView"),o=k("CrucibleTable"),C=k("CrucibleResultsTable"),w=k("CrucibleSquareStatsTable");return i(),d(y,null,[h(r),e("div",ie,[t[2]||(t[2]=e("div",{class:"top-image-container"},[e("img",{src:x,alt:"Stars Ending",class:"grayscale-image"}),e("img",{src:q,alt:"Logo",class:"logo-image"})],-1)),t[3]||(t[3]=e("h1",{class:"header"},"The Crucible Standings",-1)),e("div",ue,[h(o,{CruciblePlayers:a.table.cruciblePlayers.CruciblePlayers},null,8,["CruciblePlayers"])]),e("div",null,[t[0]||(t[0]=e("h1",null,"Crucible Results",-1)),h(C)]),e("div",null,[t[1]||(t[1]=e("h1",null,"Crucible Square Stats",-1)),h(w)])])],64)}const _e=P(oe,[["render",ce],["__scopeId","data-v-65b3f502"]]);export{_e as default};
